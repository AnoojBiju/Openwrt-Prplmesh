/* SPDX-License-Identifier: BSD-2-Clause-Patent
 *
 * SPDX-FileCopyrightText: 2020 the prplMesh contributors (see AUTHORS.md)
 *
 * This code is subject to the terms of the BSD+Patent license.
 * See LICENSE file for more details.
 */

#!/usr/bin/amxrt

%config {
    name = "prplmesh";
    prplmesh = {
        mod-dir = "$@@{prefix}$@@{plugin-dir}/$@@{name}/modules",
        external-mod-dir = "$@@{prefix}$@@{plugin-dir}/modules"
    };
    silent = false;
    import-dbg = true;
    dm-eventing-enabled = true;
    storage-path = "/opt/$@@{name}/share";
    storage-type = "odl";
    odl = {
        dm-load = true,
        dm-save = true,
        dm-save-on-changed = true,
        dm-save-delay = 1000,
        dm-defaults = "$@@{name}_defaults/",
        directory = "$@@{storage-path}/odl",
        dm-objects = "X_PRPL-ORG_WiFiController"

    };
    cfg-dir = "/etc/amx";
    include-dirs = [
        ".",
        "$@@{cfg-dir}/$@@{name}",
        "$@@{cfg-dir}/modules",
        "/opt/prplmesh/config/odl"
    ];
    import-dirs = [
        ".",
        "$@@{prefix}$@@{plugin-dir}/$@@{name}",
        "$@@{prefix}$@@{plugin-dir}/modules",
        "$@@{prefix}/usr/lib/amx/$@@{name}",
        "$@@{prefix}/usr/lib/amx/modules"
    ];
    //main files
    definition_file = "$@@{name}_definitions.odl";

    //persistent storage
    pcm_svc_config = {
        "Objects" = "X_PRPL-ORG_WiFiController"
    };
}

#include "mod_pcm_svc.odl";

include "$@@{definition_file}";

