<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1241px" preserveAspectRatio="none" style="width:1842px;height:1241px;background:#FFFFFF;" version="1.1" viewBox="0 0 1842 1241" width="1842px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="89.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1423.5" y="854.8828"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1782.5" y="825.75"/><rect height="133.6641" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1815.5" x="10" y="639.8203"/><rect height="241.1953" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1815.5" x="10" y="787.4844"/><rect height="146.6641" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1743.5" x="10" y="1042.6797"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="92" x2="92" y1="36.2969" y2="1206.3438"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="622.5" x2="622.5" y1="36.2969" y2="1206.3438"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1140" x2="1140" y1="36.2969" y2="1206.3438"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1428" x2="1428" y1="36.2969" y2="1206.3438"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1787.5" x2="1787.5" y1="36.2969" y2="1206.3438"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="145" x="20" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131" x="27" y="24.9951">channel_scan_task</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="145" x="20" y="1205.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131" x="27" y="1225.3389">channel_scan_task</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82" x="581.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="588.5" y="24.9951">son_slave</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82" x="581.5" y="1205.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="588.5" y="1225.3389">son_slave</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67" x="1107" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1114" y="24.9951">monitor</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67" x="1107" y="1205.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1114" y="1225.3389">monitor</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="1390" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="1397" y="24.9951">bwl_whm</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="1390" y="1205.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="1397" y="1225.3389">bwl_whm</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="56" x="1759.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="1766.5" y="24.9951">pwhm</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="56" x="1759.5" y="1205.3438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="1766.5" y="1225.3389">pwhm</text><rect fill="#FFFFFF" height="89.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1423.5" y="854.8828"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1782.5" y="825.75"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1835.5" x="0" y="66.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1835.5" y1="66.8633" y2="66.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1835.5" y1="69.8633" y2="69.8633"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="133" x="851.25" y="56.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="114" x="857.25" y="72.3638">Launching scan</text><polygon fill="#181818" points="610.5,106.5625,620.5,110.5625,610.5,114.5625,614.5,110.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="92.5" x2="616.5" y1="110.5625" y2="110.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="412" x="99.5" y="105.4966">ACTION_BACKHAUL_CHANNEL_SCAN_TRIGGER_SCAN_REQUEST</text><polygon fill="#181818" points="1128.5,135.6953,1138.5,139.6953,1128.5,143.6953,1132.5,139.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="622.5" x2="1134.5" y1="139.6953" y2="139.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="400" x="629.5" y="134.6294">ACTION_MONITOR_CHANNEL_SCAN_TRIGGER_SCAN_REQUEST</text><polygon fill="#181818" points="1416.5,164.8281,1426.5,168.8281,1416.5,172.8281,1420.5,168.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1140.5" x2="1422.5" y1="168.8281" y2="168.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="1147.5" y="163.7622">channel_scan_trigger()</text><polygon fill="#181818" points="1775.5,193.9609,1785.5,197.9609,1775.5,201.9609,1779.5,197.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1428.5" x2="1781.5" y1="197.9609" y2="197.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="1435.5" y="192.895">WiFi.Radio.x.startScan()</text><line style="stroke:#181818;stroke-width:1.0;" x1="1428.5" x2="1470.5" y1="227.0938" y2="227.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="1470.5" x2="1470.5" y1="227.0938" y2="240.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="1429.5" x2="1470.5" y1="240.0938" y2="240.0938"/><polygon fill="#181818" points="1439.5,236.0938,1429.5,240.0938,1439.5,244.0938,1435.5,240.0938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="314" x="1435.5" y="222.0278">Event::Channel_Scan_Triggered (synthetic event)</text><polygon fill="#181818" points="1151.5,265.2266,1141.5,269.2266,1151.5,273.2266,1147.5,269.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1145.5" x2="1427.5" y1="269.2266" y2="269.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="1157.5" y="264.1606">Event::Channel_Scan_Triggered</text><polygon fill="#181818" points="633.5,294.3594,623.5,298.3594,633.5,302.3594,629.5,298.3594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="627.5" x2="1139.5" y1="298.3594" y2="298.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="402" x="639.5" y="293.2935">ACTION_MONITOR_CHANNEL_SCAN_TRIGGERED_NOTIFICATION</text><polygon fill="#181818" points="103.5,323.4922,93.5,327.4922,103.5,331.4922,99.5,327.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="97.5" x2="621.5" y1="327.4922" y2="327.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="414" x="109.5" y="322.4263">ACTION_BACKHAUL_CHANNEL_SCAN_TRIGGERED_NOTIFICATION</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1835.5" x="0" y="356.0586"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1835.5" y1="356.0586" y2="356.0586"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1835.5" y1="359.0586" y2="359.0586"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="218" x="808.75" y="345.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="199" x="814.75" y="361.5591">Retrieving Results : Polling</text><polygon fill="#181818" points="610.5,413.8906,620.5,417.8906,610.5,421.8906,614.5,417.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="92.5" x2="616.5" y1="417.8906" y2="417.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="418" x="99.5" y="412.8247">ACTION_BACKHAUL_CHANNEL_SCAN_DUMP_RESULTS_REQUEST</text><path d="M627,383.625 L627,438.625 L951,438.625 L951,393.625 L941,383.625 L627,383.625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M941,383.625 L941,393.625 L951,393.625 L941,383.625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261" x="633" y="400.6919">only sent if dwell time == 0; dwell time is</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="303" x="633" y="415.8247">a parameter in a vendor extension, not present</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="268" x="633" y="430.9575">in standard EasyMesh 1905 Scan Request</text><polygon fill="#181818" points="1128.5,461.1563,1138.5,465.1563,1128.5,469.1563,1132.5,465.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="622.5" x2="1134.5" y1="465.1563" y2="465.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="406" x="629.5" y="460.0903">ACTION_MONITOR_CHANNEL_SCAN_DUMP_RESULTS_REQUEST</text><polygon fill="#181818" points="1416.5,490.2891,1426.5,494.2891,1416.5,498.2891,1420.5,494.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1140.5" x2="1422.5" y1="494.2891" y2="494.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244" x="1147.5" y="489.2231">channel_scan_dump_cached_results()</text><polygon fill="#181818" points="1151.5,519.4219,1141.5,523.4219,1151.5,527.4219,1147.5,523.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1145.5" x2="1427.5" y1="523.4219" y2="523.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227" x="1157.5" y="518.356">Event::Channel_Scan_Dump_Result</text><polygon fill="#181818" points="633.5,548.5547,623.5,552.5547,633.5,556.5547,629.5,552.5547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="627.5" x2="1139.5" y1="552.5547" y2="552.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="490" x="639.5" y="547.4888">ACTION_MONITOR_CHANNEL_SCAN_RESULTS_NOTIFICATION(is_dump : true)</text><polygon fill="#181818" points="103.5,577.6875,93.5,581.6875,103.5,585.6875,99.5,581.6875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="97.5" x2="621.5" y1="581.6875" y2="581.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="502" x="109.5" y="576.6216">ACTION_BACKHAUL_CHANNEL_SCAN_RESULTS_NOTIFICATION(is_dump : true)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1835.5" x="0" y="610.2539"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1835.5" y1="610.2539" y2="610.2539"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1835.5" y1="613.2539" y2="613.2539"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="260" x="787.75" y="599.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="241" x="793.75" y="615.7544">Retrieving Results : Event-driven</text><path d="M10,639.8203 L486,639.8203 L486,646.9531 L476,656.9531 L10,656.9531 L10,639.8203 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="133.6641" style="stroke:#000000;stroke-width:1.5;" width="1815.5" x="10" y="639.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="431" x="25" y="652.8872">Transition Channel Scan FSM to WAIT_FOR_RESULTS_DUMP</text><polygon fill="#181818" points="1439.5,674.0859,1429.5,678.0859,1439.5,682.0859,1435.5,678.0859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1433.5" x2="1786.5" y1="678.0859" y2="678.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246" x="1445.5" y="673.02">WiFi.Radio.x.ScanComplete notification</text><polygon fill="#181818" points="1151.5,703.2188,1141.5,707.2188,1151.5,711.2188,1147.5,707.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1145.5" x2="1427.5" y1="707.2188" y2="707.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264" x="1157.5" y="702.1528">Event:Channel_Scan_New_Results_Ready</text><polygon fill="#181818" points="633.5,732.3516,623.5,736.3516,633.5,740.3516,629.5,736.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="627.5" x2="1139.5" y1="736.3516" y2="736.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="494" x="639.5" y="731.2856">ACTION_MONITOR_CHANNEL_SCAN_RESULTS_NOTIFICATION(is_dump : false)</text><polygon fill="#181818" points="103.5,761.4844,93.5,765.4844,103.5,769.4844,99.5,765.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="97.5" x2="621.5" y1="765.4844" y2="765.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="506" x="109.5" y="760.4185">ACTION_BACKHAUL_CHANNEL_SCAN_RESULTS_NOTIFICATION(is_dump : false)</text><path d="M10,787.4844 L479,787.4844 L479,794.6172 L469,804.6172 L10,804.6172 L10,787.4844 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="241.1953" style="stroke:#000000;stroke-width:1.5;" width="1815.5" x="10" y="787.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="419" x="25" y="800.5513">Retrieve Result from PWHM and push them to the agent</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="573" x="494" y="799.6948">[getScanResults() is called once; data is pushed in chunks via Scan_Dump_Result events]</text><polygon fill="#181818" points="1770.5,821.75,1780.5,825.75,1770.5,829.75,1774.5,825.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1428.5" x2="1776.5" y1="825.75" y2="825.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241" x="1435.5" y="820.6841">WiFi.Radio.x.getScanResults(&amp;results)</text><polygon fill="#181818" points="1444.5,850.8828,1434.5,854.8828,1444.5,858.8828,1440.5,854.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1438.5" x2="1786.5" y1="854.8828" y2="854.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241" x="1450.5" y="849.8169">WiFi.Radio.x.getScanResults(&amp;results)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1433.5" x2="1475.5" y1="884.0156" y2="884.0156"/><line style="stroke:#181818;stroke-width:1.0;" x1="1475.5" x2="1475.5" y1="884.0156" y2="897.0156"/><line style="stroke:#181818;stroke-width:1.0;" x1="1434.5" x2="1475.5" y1="897.0156" y2="897.0156"/><polygon fill="#181818" points="1444.5,893.0156,1434.5,897.0156,1444.5,901.0156,1440.5,897.0156" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335" x="1440.5" y="878.9497">Event:Channel_Scan_Dump_Result (synthetic event)</text><polygon fill="#181818" points="1151.5,940.2813,1141.5,944.2813,1151.5,948.2813,1147.5,944.2813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1145.5" x2="1427.5" y1="944.2813" y2="944.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223" x="1157.5" y="939.2153">Event:Channel_Scan_Dump_Result</text><path d="M518,910.0156 L518,965.0156 L1135,965.0156 L1135,920.0156 L1125,910.0156 L518,910.0156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1125,910.0156 L1125,920.0156 L1135,920.0156 L1125,910.0156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="524" y="927.0825">notice that two distinct events,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="126" x="724" y="927.0825">New_Results_Ready</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24" x="854" y="927.0825">and</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="85" x="882" y="927.0825">Dump_Result</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="967" y="927.0825">, are mapped to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="361" x="524" y="942.2153">the same beerocks message, the difference being in the</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="62" x="889" y="942.2153">is_dump</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="955" y="942.2153">flag;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="524" y="957.3481">this flag also signals the presence (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="85" x="749" y="957.3481">Dump_Result</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="834" y="957.3481">) or absence(</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="126" x="919" y="957.3481">New_Results_Ready</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="1045" y="957.3481">) of payload</text><polygon fill="#181818" points="633.5,987.5469,623.5,991.5469,633.5,995.5469,629.5,991.5469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="627.5" x2="1139.5" y1="991.5469" y2="991.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="490" x="639.5" y="986.481">ACTION_MONITOR_CHANNEL_SCAN_RESULTS_NOTIFICATION(is_dump : true)</text><polygon fill="#181818" points="103.5,1016.6797,93.5,1020.6797,103.5,1024.6797,99.5,1020.6797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="97.5" x2="621.5" y1="1020.6797" y2="1020.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="502" x="109.5" y="1015.6138">ACTION_BACKHAUL_CHANNEL_SCAN_RESULTS_NOTIFICATION(is_dump : true)</text><path d="M10,1042.6797 L381,1042.6797 L381,1049.8125 L371,1059.8125 L10,1059.8125 L10,1042.6797 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="146.6641" style="stroke:#000000;stroke-width:1.5;" width="1743.5" x="10" y="1042.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="326" x="25" y="1055.7466">Transition Channel Scan FSM to SCAN_DONE</text><line style="stroke:#181818;stroke-width:1.0;" x1="1428.5" x2="1470.5" y1="1080.9453" y2="1080.9453"/><line style="stroke:#181818;stroke-width:1.0;" x1="1470.5" x2="1470.5" y1="1080.9453" y2="1093.9453"/><line style="stroke:#181818;stroke-width:1.0;" x1="1429.5" x2="1470.5" y1="1093.9453" y2="1093.9453"/><polygon fill="#181818" points="1439.5,1089.9453,1429.5,1093.9453,1439.5,1097.9453,1435.5,1093.9453" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306" x="1435.5" y="1075.8794">Event::Channel_Scan_Finished (synthetic event)</text><polygon fill="#181818" points="1151.5,1119.0781,1141.5,1123.0781,1151.5,1127.0781,1147.5,1123.0781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1145.5" x2="1427.5" y1="1123.0781" y2="1123.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="1157.5" y="1118.0122">Event::Channel_Scan_Finished</text><polygon fill="#181818" points="633.5,1148.2109,623.5,1152.2109,633.5,1156.2109,629.5,1152.2109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="627.5" x2="1139.5" y1="1152.2109" y2="1152.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="390" x="639.5" y="1147.145">ACTION_MONITOR_CHANNEL_SCAN_FINISHED_NOTIFICATION</text><polygon fill="#181818" points="103.5,1177.3438,93.5,1181.3438,103.5,1185.3438,99.5,1181.3438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="97.5" x2="621.5" y1="1181.3438" y2="1181.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="402" x="109.5" y="1176.2778">ACTION_BACKHAUL_CHANNEL_SCAN_FINISHED_NOTIFICATION</text><!--MD5=[886ba0efbd66cc7243ef66a7ed398fae]
@startuml

participant channel_scan_task
participant son_slave
participant monitor
participant bwl_whm
participant pwhm

== Launching scan ==

channel_scan_task -> son_slave : ACTION_BACKHAUL_CHANNEL_SCAN_TRIGGER_SCAN_REQUEST

son_slave -> monitor : ACTION_MONITOR_CHANNEL_SCAN_TRIGGER_SCAN_REQUEST

monitor -> bwl_whm : channel_scan_trigger()

bwl_whm -> pwhm : WiFi.Radio.x.startScan()

bwl_whm -> bwl_whm : Event::Channel_Scan_Triggered (synthetic event)

bwl_whm - -> monitor : Event::Channel_Scan_Triggered

monitor - -> son_slave : ACTION_MONITOR_CHANNEL_SCAN_TRIGGERED_NOTIFICATION

son_slave - -> channel_scan_task : ACTION_BACKHAUL_CHANNEL_SCAN_TRIGGERED_NOTIFICATION




== Retrieving Results : Polling ==

channel_scan_task -> son_slave : ACTION_BACKHAUL_CHANNEL_SCAN_DUMP_RESULTS_REQUEST
note right
  only sent if dwell time == 0; dwell time is
  a parameter in a vendor extension, not present
  in standard EasyMesh 1905 Scan Request
end note

son_slave -> monitor : ACTION_MONITOR_CHANNEL_SCAN_DUMP_RESULTS_REQUEST

monitor -> bwl_whm : channel_scan_dump_cached_results()

bwl_whm - -> monitor : Event::Channel_Scan_Dump_Result

monitor - -> son_slave : ACTION_MONITOR_CHANNEL_SCAN_RESULTS_NOTIFICATION(is_dump : true)

son_slave - -> channel_scan_task : ACTION_BACKHAUL_CHANNEL_SCAN_RESULTS_NOTIFICATION(is_dump : true)



== Retrieving Results : Event-driven ==

group Transition Channel Scan FSM to WAIT_FOR_RESULTS_DUMP
	bwl_whm <- pwhm : WiFi.Radio.x.ScanComplete notification
	monitor <- bwl_whm : Event:Channel_Scan_New_Results_Ready
	son_slave <- monitor : ACTION_MONITOR_CHANNEL_SCAN_RESULTS_NOTIFICATION(is_dump : false)
	channel_scan_task <- son_slave : ACTION_BACKHAUL_CHANNEL_SCAN_RESULTS_NOTIFICATION(is_dump : false)
end

group Retrieve Result from PWHM and push them to the agent [getScanResults() is called once; data is pushed in chunks via Scan_Dump_Result events]
	bwl_whm -> pwhm : WiFi.Radio.x.getScanResults(&results)
	activate pwhm
	pwhm - -> bwl_whm : WiFi.Radio.x.getScanResults(&results)
	deactivate pwhm

	activate bwl_whm
	bwl_whm -> bwl_whm : Event:Channel_Scan_Dump_Result (synthetic event)

	monitor <- bwl_whm : Event:Channel_Scan_Dump_Result
	deactivate bwl_whm
	
	note left
	  notice that two distinct events, //New_Results_Ready// and //Dump_Result//, are mapped to 
	  the same beerocks message, the difference being in the **is_dump** flag;
	  this flag also signals the presence (//Dump_Result//) or absence(//New_Results_Ready//) of payload
	end note

	son_slave <- monitor : ACTION_MONITOR_CHANNEL_SCAN_RESULTS_NOTIFICATION(is_dump : true)
	channel_scan_task <- son_slave : ACTION_BACKHAUL_CHANNEL_SCAN_RESULTS_NOTIFICATION(is_dump : true)
end

group Transition Channel Scan FSM to SCAN_DONE
	bwl_whm -> bwl_whm : Event::Channel_Scan_Finished (synthetic event)
	monitor <- bwl_whm : Event::Channel_Scan_Finished
	son_slave <- monitor : ACTION_MONITOR_CHANNEL_SCAN_FINISHED_NOTIFICATION
	channel_scan_task <- son_slave : ACTION_BACKHAUL_CHANNEL_SCAN_FINISHED_NOTIFICATION
end

@enduml

PlantUML version 1.2022.6(Tue Jun 21 19:34:49 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: fr
Country: FR
--></g></svg>